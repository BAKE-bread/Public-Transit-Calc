# 关于一种带首位锚定的随机位置投票模型中计分并列问题的分析

### 摘要

本文深入研究了一个特定的随机投票模型中，各候选项最终得分出现并列的概率问题。该模型包含 $n$ 个候选项，并为每个候选项 $i$ 生成一张固定其为第一名的选票，其余 $n-1$ 个候选项则进行均匀随机排序。我们采用位置计分法（Borda Count 的变体）为每个名次赋分，并聚合计算各候选项的总分。本文首先给出了该问题的形式化定义，然后结合解析推导、精确枚举和数值计算（FFT）等方法，系统地分析了并列概率的行为。

研究的核心成果包括：我们精确推导了任意一对候选项分数差的方差表达式，并利用局部中心极限定理得出了单对并列概率随 $n$ 增长的渐近行为（约为 $\mathcal{O}(n^{-3/2})$）。我们证明了，虽然单对并列的概率单调递减，但由于候选项对数的增长，期望并列对数是单调递增的，这导致“至少存在一对并列”的总概率在 $n$ 较大时趋近于1。

特别地，本文对在小 $n$ 值（尤其是在 $n=5$ 处）观察到的总并列概率非单调“下凹”现象进行了深入的诊断和解释。通过对并列类型的分类统计，我们证明了该现象并非源于基础并列趋势的减弱，而是一种由并列事件的**组合结构突变**导致的现象：系统在 $n=4$ 时异常地倾向于产生结构复杂的“多重并列”，而在 $n=5$ 时则转变为以结构简单的“单对并列”为主，从而导致总概率的短暂下降。

---

### 1. 形式化定义

**对象**:
一个包含 $n$ 个候选项（或元素）的集合 $C = \{1, 2, \dots, n\}$。

**计分规则**:
给定一个严格递减的位置计分向量 $\mathbf{w} = (w_1, w_2, \dots, w_n)$，其中 $w_1 > w_2 > \dots > w_n$。在本研究中，我们采用 Borda 计分的仿射变换形式，即 $\mathbf{w} = (n, n-1, \dots, 1)$。

**排列生成（首位锚定）**:
构造 $n$ 张独立的排列（或称“选票”）$\sigma_1, \dots, \sigma_n$。对每个 $i \in C$，排列 $\sigma_i$ 的生成规则如下：
1. 候选项 $i$ 被固定在第1名（首位锚定）。
2. 其余 $n-1$ 个候选项在剩下的 $n-1$ 个位置上进行均匀随机排列。
因此，总的样本空间大小为 $((n-1)!)^n$。

**聚合分数**:
对任一候选项 $j \in C$，其总分 $S_j$ 定义为它在所有 $n$ 张选票中得分的总和：
$$S_j = \sum_{i=1}^{n} w_{\text{rank}_{\sigma_i}(j)}$$
其中 $\text{rank}_{\sigma_i}(j)$ 是候选项 $j$ 在选票 $\sigma_i$ 中的名次。

**研究事件**:
我们关注“至少存在一对并列”事件，即：
$$ E_{\text{any_tie}} = \{ \exists \, j \neq k \text{ s.t. } S_j = S_k \} $$

---

### 2. 求解思路与核心方法

解决此问题的策略是分层递进的：
1.  **精确枚举 (Exact Enumeration)**: 对于小 $n$ (如 $n \le 5$)，直接遍历所有 $((n-1)!)^n$ 种可能的配置，计算每种配置下的分数并统计并列情况。这是获取精确概率和诊断复杂结构的基础。
2.  **分析分数差变量 (Pairwise Difference)**: 为了进行解析推导，我们不直接分析分数向量 $\mathbf{S}$，而是集中研究任意一对候选项 $(a, b)$ 的分数差 $D_{ab} = S_a - S_b$。由于不同选票是独立生成的，$D_{ab}$ 可以表示为 $n$ 个独立随机变量之和 $D_{ab} = \sum_{i=1}^n X_i$，这极大地简化了分析。
3.  **特征函数与FFT (Characteristic Functions & FFT)**: 为了精确计算单对并列概率 $\mathbb{P}(D_{ab}=0)$，我们采用特征函数（即概率质量函数的傅里叶变换）的方法。卷积在时域上对应于在频域上的乘积。通过FFT可以高效地计算卷积，从而得到 $D_{ab}$ 的精确概率分布。
4.  **局部中心极限定理 (Local CLT)**: 当 $n$ 较大时，作为独立变量之和的 $D_{ab}$ 的分布趋近于正态分布。利用局部中心极限定理，我们可以得到 $\mathbb{P}(D_{ab}=0)$ 的渐近近似公式。
5.  **期望分析 (Analysis of Expectation)**: 通过计算期望并列对数 $\mathbb{E}[Y] = \binom{n}{2}\mathbb{P}(S_a=S_b)$，我们可以分析总体并列趋势，并解释为何总概率会趋向于1。

---

### 3. 关键证明与推导

#### 3.1. 分数差 $D_{ab}$ 的均值与方差

令 $\mu$ 和 $\sigma^2$ 分别为非首位得分集合 $\{n-1, \dots, 1\}$ 的均值和方差。
$$ \mu = \frac{n}{2}, \quad \sigma^2 = \frac{n(n-2)}{12} $$
分数差 $D_{ab} = \sum_{i=1}^n X_i$，其中 $X_i$ 是第 $i$ 张票的得分贡献差。
- **当 $i=a$**: $X_a = n - W$，其中 $W$ 从 $\{n-1, \dots, 1\}$ 中均匀抽取。$\mathbb{E}[X_a] = n-\mu$，$\text{Var}(X_a)=\sigma^2$。
- **当 $i=b$**: $X_b = W' - n$。$\mathbb{E}[X_b] = \mu-n$，$\text{Var}(X_b)=\sigma^2$。
- **当 $i \notin \{a, b\}$**: $X_i = U-V$，其中 $U,V$ 从 $\{n-1, \dots, 1\}$ 中无放回抽取。$\mathbb{E}[X_i]=0$，$\text{Var}(X_i) = 2\sigma^2 \frac{n-1}{n-2}$。

**均值**: 由对称性，$\mathbb{E}[D_{ab}] = \sum \mathbb{E}[X_i] = (n-\mu) + (\mu-n) + (n-2) \cdot 0 = 0$。

**方差**:
$$ \text{Var}(D_{ab}) = \sum \text{Var}(X_i) = \text{Var}(X_a) + \text{Var}(X_b) + \sum_{i \notin \{a,b\}} \text{Var}(X_i) $$
$$ = \sigma^2 + \sigma^2 + (n-2) \cdot \left(2\sigma^2 \frac{n-1}{n-2}\right) = 2\sigma^2 + 2\sigma^2(n-1) = 2n\sigma^2 $$
代入 $\sigma^2 = \frac{n(n-2)}{12}$，我们得到 Borda 计分下的特定方差：
$$ \text{Var}(D_{ab}) = 2n \cdot \frac{n(n-2)}{12} = \frac{n^2(n-2)}{6} $$

#### 3.2. 单对并列概率

利用局部中心极限定理，我们得到其渐近行为：
$$ \mathbb{P}(S_a=S_b) = \mathbb{P}(D_{ab}=0) \approx \frac{1}{\sqrt{2\pi \text{Var}(D_{ab})}} = \frac{1}{\sqrt{2\pi \frac{n^2(n-2)}{6}}} \sim \frac{\sqrt{3}}{\sqrt{\pi}} n^{-3/2} $$
使用FFT方法可以得到精确值，数值结果表明 $\mathbb{P}(S_a=S_b)$ 随 $n$ 严格单调递减。

#### 3.3. 整体并列概率趋势

期望并列对数 $Y = \sum_{1 \le a < b \le n} \mathbf{1}_{\{S_a=S_b\}}$ 为：
$$ \mathbb{E}[Y] = \binom{n}{2}\mathbb{P}(S_a=S_b) \approx \frac{n(n-1)}{2} \cdot \frac{\sqrt{3}}{\sqrt{\pi}}n^{-3/2} \sim \frac{\sqrt{3}}{2\sqrt{\pi}}\sqrt{n} $$
由于 $\mathbb{E}[Y] \to \infty$ 当 $n \to \infty$，可以推断 $\mathbb{P}(\text{存在并列}) = \mathbb{P}(Y>0) \to 1$。

---

### 4. 特殊结构解释：n=5 局部极小值之谜

#### 4.1. 现象确认

精确枚举结果证实了该现象的存在。总并列概率 $P(\text{any tie})$ 表现出非单调行为：
- **P(n=3)**: 0.250000
- **P(n=4)**: 0.722222 (峰值)
- **P(n=5)**: 0.695186 (下凹)
- **P(n=6)**: ~0.74 (根据模拟，开始回升)

#### 4.2. 核心原因分析

**首先，排除简单解释**：期望并列对数 `E[Tied Pairs]` 的精确计算结果是**单调递增**的（0.75 → 1.00 → 1.08...）。这表明，系统内发生碰撞的“平均火力”并未减弱。因此，总概率的下凹必有更深层次的结构性原因。

**最终解释：并列类型的组合结构突变**

通过对并列类型的分类统计，我们发现：
> 在 $n=4$ 时，系统异常地倾向于产生结构复杂的**多重并列**（例如，三方或四方并列，或同时出现两对并列）。而在 $n=5$ 时，系统的并列结构发生了转变，绝大多数并列情况都是结构简单的**单对并列**。

**数据佐证 (来自精确枚举):**
- **在 n=4 时**: 产生的结果只有1、2或3个不同分数的概率（即复杂并列）总和高达 **16.7%**。
- **在 n=5 时**: 产生的结果只有1、2或3个不同分数的概率骤降至 **0.7%** 左右。绝大多数并列配置（占比44.3%）都表现为只有4个不同分数（即恰好一对并列）。

可以形象地理解为：
> - **n=4 的并列**：像一颗“集束炸弹”，一旦发生，常常导致多个目标（候选项对）同时被“击中”（并列）。
> - **n=5 的并列**：更像一支“步枪”，虽然“开火”的平均次数（期望并列对数）更多，但每次通常只“击中”一个目标。

因此，即使 $n=5$ 的平均碰撞次数更高，但由于 $n=4$ 存在大量高效产生“至少一次碰撞”的“集束炸弹”式组合，导致其总的并列概率 $P(\text{any tie})$ 反而更高。

---

### 5. 结论

本文对一个带首位锚定的随机位置投票模型中的计分并列问题进行了全面分析。我们证明了其总并列概率随 $n$ 增大趋向于1的宏观趋势，并成功揭示了在小 $n$ 范围内（尤其是在 $n=5$ 处）出现的总概率非单调现象。该现象的本质是一个微妙的组合效应，即并列事件的内部结构从 $n=4$ 的“复杂多发”模式转变为 $n=5$ 的“简单单发”模式，从而导致了总概率的局部下凹。这项研究不仅为该特定模型提供了完整的概率画像，也揭示了在随机组合系统中，宏观概率行为可能受到微观结构突变的深刻影响。

